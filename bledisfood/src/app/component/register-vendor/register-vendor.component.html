<div class="card">
  <mat-card>
    <h1 class="title">Formulaire d'inscription</h1>
    <form [formGroup]="registerForm" (ngSubmit)="onSubmit()" *ngIf="isReady">
      <mat-card-content class="card-content">

        <mat-form-field appearance="legacy" class="input-field">
          <mat-label class="input-label" >Nom</mat-label>
          <input matInput placeholder="" formControlName="last_name" [ngClass]="{ 'is-invalid': submitted && registerForm.get('last_name')?.errors }">
          <div *ngIf="submitted && registerForm.get('last_name')?.errors" class="invalid-feedback">
              <div *ngIf="registerForm.get('last_name')?.hasError('required')">Un nom est requis</div>
              <div *ngIf="registerForm.get('last_name')?.hasError('pattern')">Le nom est invalide ! (minimum 2 lettres)</div>
          </div>
        </mat-form-field>

        <mat-form-field appearance="legacy" class="input-field">
          <mat-label class="input-label">Prénom</mat-label>
          <input matInput placeholder="" formControlName="first_name" [ngClass]="{ 'is-invalid' : submitted && registerForm.get('first_name')?.errors}">
          <div *ngIf="submitted && registerForm.get('first_name')?.errors" class="invalid-feedback">
              <div *ngIf="registerForm.get('first_name')?.hasError('required')">Un prénom est requis</div>
              <div *ngIf="registerForm.get('first_name')?.hasError('pattern')">Le prénom est invalide ! (minimum 2 lettres)</div>

          </div>
        </mat-form-field>

        <mat-form-field appearance="legacy" class="input-field">
          <mat-label class="input-label">E-mail</mat-label>
          <input type="email" matInput placeholder="" formControlName="email"
            [ngClass]="{'is-invalid' : submitted && registerForm.get('email')?.errors}">
          <div *ngIf="submitted && registerForm.get('email')?.errors" class="invalid-feedback">
            <div *ngIf="registerForm.get('email')?.hasError('required')">Un email est requis</div>
            <div *ngIf="registerForm.get('email')?.hasError('pattern')">Le mail n'est pas valide</div>
          </div>

        </mat-form-field>

        <mat-form-field appearance="legacy" class="input-field">
          <mat-label class="input-label">Nom d'utilisateur</mat-label>
          <input matInput placeholder="" formControlName="username"
            [ngClass]="{'is-invalid' : submitted && registerForm.get('username')?.errors}">
          <div *ngIf="submitted && registerForm.get('username').errors" class="invalid-feedback">
            <div *ngIf="registerForm.get('username')?.hasError('required')">Un nom d'utilisateur est requis</div>
            <div *ngIf="registerForm.get('username')?.hasError('pattern')">Le nom d'utilisateur doit au moins comporter 3 lettres (chiffres non acceptés) !</div>
          </div>
        </mat-form-field>

        <mat-form-field appearance="legacy" class="input-field">
          <mat-label class="input-label">Mot de passe</mat-label>
          <input matInput placeholder="" formControlName="password" type="password"
            [ngClass]="{'is-invalid' : submitted && registerForm.get('password')?.errors}">
          <div *ngIf="submitted && registerForm.get('password')?.errors" class="invalid-feedback">
            <div *ngIf="registerForm.get('password')?.hasError('required')">Un mot de passe est requis</div>
            <div *ngIf="registerForm.get('password')?.hasError('minlength')">Le mot de passe doit faire au moins 6 caractères</div>
          </div>
        </mat-form-field>

        <mat-form-field appearance="legacy" class="input-field">
          <mat-label class="input-label">Confirmer le mot de passe</mat-label>
          <input matInput placeholder="" formControlName="password_confirm" type="password"  [ngClass]="{ 'is-invalid' : submitted && registerForm.get('password_confirm')?.errors}">
          <div *ngIf="submitted && registerForm.get('password_confirm')?.errors" class="invalid-feedback">
              <div *ngIf="registerForm.get('password_confirm')?.hasError('required')">Veuillez confirmer le mot de passe</div>
              <div *ngIf="registerForm.get('password_confirm')?.hasError('mustMatch')">Les mots de passe ne correspondent pas !</div>
          </div>
        </mat-form-field>

        <mat-form-field appearance="legacy" class="input-field">
          <mat-label class="input-label">IBAN</mat-label>
          <input matInput placeholder="" formControlName="IBAN" [(ngModel)]="iban"
            [ngClass]="{ 'is-invalid' : submitted && registerForm.get('IBAN')?.errors}">
          <div *ngIf="submitted && registerForm.get('IBAN')?.errors" class="invalid-feedback">
            <div *ngIf="registerForm.get('IBAN')?.hasError('required')">Un IBAN est requis</div>
          </div>
        </mat-form-field>
        <div class="table-field">
          <mat-form-field appearance="legacy" class="adresse-field">
            <mat-label class="input-label">Adresse</mat-label>
            <input matInput type="text" placeholder="" formControlName="adresse" [ngClass]="{ 'is-invalid' : submitted && registerForm.get('adresse')?.errors}">
            <div *ngIf="submitted && registerForm.get('adresse')?.errors" class="invalid-feedback">
              <div *ngIf="registerForm.get('adresse')?.hasError('required')" id="adresseError">Une adresse est requise</div>
            </div>
          </mat-form-field>

          <mat-form-field appearance="legacy" class="noStreet-field">
            <mat-label class="input-label">No de rue</mat-label>
            <input matInput placeholder="" formControlName="no_rue" [ngClass]="{ 'is-invalid' : submitted && registerForm.get('no_rue')?.errors}">
            <div *ngIf="submitted && registerForm.get('no_rue')?.errors" class="invalid-feedback">
              <div *ngIf="registerForm.get('no_rue')?.hasError('required')">Un chiffre est requis</div>
              <div *ngIf="registerForm.get('no_rue')?.hasError('pattern')">Numéro de rue invalide !</div>
            </div>
          </mat-form-field>
        </div>
      
        <mat-form-field appearance="legacy" class="input-field">
          <mat-label class="input-label">Code postal</mat-label>
          <input matInput type="number" placeholder="" formControlName="code_postal"
            [ngClass]="{ 'is-invalid' : submitted && registerForm.get('code_postal')?.errors}" ng-minlength=4 ng-maxlength=4>
          <div *ngIf="submitted && registerForm.get('code_postal')?.errors" class="invalid-feedback">
            <div *ngIf="registerForm.get('code_postal')?.hasError('required')">Un code postal est requis</div>
            <div *ngIf="registerForm.get('code_postal')?.hasError('min')">Veuillez saisir un code postal valide ! (Exemple : 1207)</div>
            <div *ngIf="registerForm.get('code_postal')?.hasError('max')">Veuillez saisir un code postal valide ! (Exemple : 1207)</div>
          </div>
        </mat-form-field>

        <mat-form-field appearance="legacy" class="input-field">
          <mat-label class="input-label">Ville</mat-label>
          <input matInput placeholder="" formControlName="ville"
            [ngClass]="{ 'is-invalid' : submitted && registerForm.get('ville')?.errors}">
          <div *ngIf="submitted && registerForm.get('ville')?.errors" class="invalid-feedback">
            <div *ngIf="registerForm.get('ville')?.hasError('required')">Une ville est requise</div>
          </div>
        </mat-form-field>

        <mat-form-field appearance="legacy" class="input-field">
          <mat-label class="input-label">Pays</mat-label>
          <input matInput placeholder="" [value]="pays" [ngClass]="{ 'is-invalid' : submitted && registerForm.get('pays')?.errors}"
            disabled>
          <div *ngIf="submitted && registerForm.get('pays')?.errors" class="invalid-feedback">
            <div *ngIf="registerForm.get('pays')?.hasError('required')">Un pays est requis</div>
          </div>
        </mat-form-field>
        <br />
        <br />
        <div class="photo-wrapper">
          <mat-label class="input-label">Photo de profil &nbsp; </mat-label>
          <input type="file" name="photo" formControlName="photo" accept="image/*" (change)="onChange($event)">    
        </div>

      </mat-card-content>
      <mat-card-actions class="card-action">
        <button mat-raised-button color="primary" class="button-field" type="submit">S'inscrire</button>
      </mat-card-actions>
    </form>
  </mat-card>
</div>
